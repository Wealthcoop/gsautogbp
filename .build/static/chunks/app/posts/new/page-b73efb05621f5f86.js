(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[106],{7116:function(e,s,a){Promise.resolve().then(a.bind(a,1162)),Promise.resolve().then(a.bind(a,6482))},6482:function(e,s,a){"use strict";a.d(s,{default:function(){return C}});var t=a(7437),l=a(2265),i=a(3287),r=a(9376),n=a(2660),c=a(2720),d=a(8420),o=a(1047),h=a(3113),m=a(7689),u=a(1817),x=a(2883),j=a(1723),p=a(2208),g=a(3229),f=a(2869),v=a(5186),N=a(7129),y=a(6818),w=a(6070),b=a(3647),S=a(8356),E=a(5974),F=a(5153),P=a(7648);function C(){let[e,s]=(0,l.useState)(""),[a,C]=(0,l.useState)(""),[k,Z]=(0,l.useState)("UPDATE"),[D,O]=(0,l.useState)(""),[T,_]=(0,l.useState)([]),[U,I]=(0,l.useState)(""),[V,Y]=(0,l.useState)(""),[L,M]=(0,l.useState)(""),[z,A]=(0,l.useState)(""),[R,B]=(0,l.useState)(""),[G,Q]=(0,l.useState)(""),[q,J]=(0,l.useState)(""),[H,W]=(0,l.useState)(""),[$,K]=(0,l.useState)(!1),[X,ee]=(0,l.useState)(!1),[es,ea]=(0,l.useState)(null),[et,el]=(0,l.useState)(!1),ei=(0,r.useRouter)(),{toast:er}=(0,F.pm)();(0,l.useEffect)(()=>{en(),ec()},[]);let en=async()=>{try{let e=await fetch("/api/usage");if(e.ok){let s=await e.json();ea(s)}}catch(e){console.error("Error fetching usage:",e)}},ec=async()=>{el(!0);try{let e=await fetch("/api/businesses");if(e.ok){let s=await e.json();_(s.businesses||[])}}catch(e){console.error("Error fetching businesses:",e),er({title:"Error",description:"Failed to load your businesses",variant:"destructive"})}finally{el(!1)}},ed=async()=>{if(!H.trim()){er({title:"Error",description:"Please enter a description for the image",variant:"destructive"});return}K(!0);try{let e=await fetch("/api/generate-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:H})});if(e.ok){let s=await e.json();I(s.imageUrl),er({title:"Success",description:"Image generated successfully"})}else throw Error("Failed to generate image")}catch(e){console.error("Error generating image:",e),er({title:"Error",description:"Failed to generate image",variant:"destructive"})}finally{K(!1)}},eo=async(s=!0)=>{if(!e.trim()||!a.trim()){er({title:"Error",description:"Please fill in title and content",variant:"destructive"});return}if(!es?.canCreatePost&&!s){er({title:"Limit Reached",description:"You have reached your monthly post limit. Upgrade to unlimited plan.",variant:"destructive"});return}ee(!0);try{let t=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,content:a,type:k,businessId:D||null,imageUrl:U||null,scheduledAt:!s&&V?V:null,eventStartDate:"EVENT"===k?L:null,eventEndDate:"EVENT"===k?z:null,eventLocation:"EVENT"===k?R:null,offerValidUntil:"OFFER"===k?G:null,offerTerms:"OFFER"===k?q:null})});if(t.ok)er({title:"Success",description:s?"Post saved as draft":"Post scheduled successfully"}),ei.push("/posts");else{let e=await t.json();throw Error(e.error||"Failed to save post")}}catch(e){console.error("Error saving post:",e),er({title:"Error",description:e.message||"Failed to save post",variant:"destructive"})}finally{ee(!1)}};return(0,t.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,t.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(f.z,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsxs)(P.default,{href:"/posts",children:[(0,t.jsx)(n.Z,{className:"h-4 w-4 mr-2"}),"Back to Posts"]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Create New Post"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Create engaging content for your Google Business Profile"})]})]})}),es&&!es.canCreatePost&&(0,t.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:(0,t.jsx)(w.Zb,{className:"border-destructive/50 bg-destructive/5",children:(0,t.jsx)(w.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Monthly limit reached"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["You've used ",es.currentUsage," of ",es.limit," posts this month"]})]}),(0,t.jsx)(f.z,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsx)(P.default,{href:"/upgrade",children:"Upgrade Plan"})})]})})})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)(w.Zb,{className:"card-shadow",children:[(0,t.jsx)(w.Ol,{children:(0,t.jsxs)(w.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Z,{className:"h-5 w-5"}),"Post Details"]})}),(0,t.jsxs)(w.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"title",children:"Title"}),(0,t.jsx)(v.I,{id:"title",placeholder:"Enter post title...",value:e,onChange:e=>s(e.target.value),className:"mt-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"type",children:"Post Type"}),(0,t.jsxs)(b.Ph,{value:k,onValueChange:Z,children:[(0,t.jsx)(b.i4,{className:"mt-1",children:(0,t.jsx)(b.ki,{})}),(0,t.jsxs)(b.Bw,{children:[(0,t.jsx)(b.Ql,{value:"UPDATE",children:"General Update"}),(0,t.jsx)(b.Ql,{value:"EVENT",children:"Event"}),(0,t.jsx)(b.Ql,{value:"OFFER",children:"Offer/Promotion"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"business",children:"Business Location"}),(0,t.jsxs)(b.Ph,{value:D,onValueChange:O,children:[(0,t.jsx)(b.i4,{className:"mt-1",children:(0,t.jsx)(b.ki,{placeholder:et?"Loading businesses...":"Select a business (optional)"})}),(0,t.jsx)(b.Bw,{children:T.length>0?T.map(e=>(0,t.jsx)(b.Ql,{value:e.id,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.Z,{className:"h-4 w-4"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.name}),e.address&&(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.address})]})]})},e.id)):(0,t.jsx)(b.Ql,{value:"",disabled:!0,children:et?"Loading...":"No businesses found"})})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a business to publish directly to Google Business Profile"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"content",children:"Content"}),(0,t.jsx)(y.g,{id:"content",placeholder:"Write your post content here...",value:a,onChange:e=>C(e.target.value),className:"mt-1 min-h-32"})]})]})]}),"EVENT"===k&&(0,t.jsxs)(w.Zb,{className:"card-shadow",children:[(0,t.jsx)(w.Ol,{children:(0,t.jsxs)(w.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Z,{className:"h-5 w-5"}),"Event Details"]})}),(0,t.jsxs)(w.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"eventStartDate",children:"Start Date"}),(0,t.jsx)(v.I,{id:"eventStartDate",type:"datetime-local",value:L,onChange:e=>M(e.target.value),className:"mt-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"eventEndDate",children:"End Date"}),(0,t.jsx)(v.I,{id:"eventEndDate",type:"datetime-local",value:z,onChange:e=>A(e.target.value),className:"mt-1"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"eventLocation",children:"Location"}),(0,t.jsx)(v.I,{id:"eventLocation",placeholder:"Event location...",value:R,onChange:e=>B(e.target.value),className:"mt-1"})]})]})]}),"OFFER"===k&&(0,t.jsxs)(w.Zb,{className:"card-shadow",children:[(0,t.jsx)(w.Ol,{children:(0,t.jsxs)(w.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Z,{className:"h-5 w-5"}),"Offer Details"]})}),(0,t.jsxs)(w.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"offerValidUntil",children:"Valid Until"}),(0,t.jsx)(v.I,{id:"offerValidUntil",type:"datetime-local",value:G,onChange:e=>Q(e.target.value),className:"mt-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"offerTerms",children:"Terms & Conditions"}),(0,t.jsx)(y.g,{id:"offerTerms",placeholder:"Terms and conditions...",value:q,onChange:e=>J(e.target.value),className:"mt-1"})]})]})]})]}),(0,t.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.3},className:"space-y-6",children:[(0,t.jsxs)(w.Zb,{className:"card-shadow",children:[(0,t.jsx)(w.Ol,{children:(0,t.jsxs)(w.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"h-5 w-5"}),"Post Image"]})}),(0,t.jsxs)(w.aY,{children:[(0,t.jsxs)(S.mQ,{defaultValue:"upload",className:"w-full",children:[(0,t.jsxs)(S.dr,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(S.SP,{value:"upload",children:"Upload"}),(0,t.jsx)(S.SP,{value:"generate",children:"AI Generate"})]}),(0,t.jsx)(S.nU,{value:"upload",className:"space-y-4",children:(0,t.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,t.jsxs)("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer bg-muted hover:bg-muted/80 transition-colors",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,t.jsx)(m.Z,{className:"w-8 h-8 mb-2 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Click to upload image"})]}),(0,t.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:e=>{let s=e.target.files?.[0];if(s){let e=new FileReader;e.onload=e=>{I(e.target?.result)},e.readAsDataURL(s)}}})]})})}),(0,t.jsxs)(S.nU,{value:"generate",className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"imagePrompt",children:"Describe the image"}),(0,t.jsx)(y.g,{id:"imagePrompt",placeholder:"A professional business photo showing...",value:H,onChange:e=>W(e.target.value),className:"mt-1"})]}),(0,t.jsx)(f.z,{onClick:ed,disabled:$||!H.trim(),className:"w-full",children:$?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Generate Image"]})})]})]}),U&&(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("div",{className:"relative aspect-video rounded-lg overflow-hidden bg-muted",children:(0,t.jsx)("img",{src:U,alt:"Post preview",className:"w-full h-full object-cover"})})})]})]}),(0,t.jsxs)(w.Zb,{className:"card-shadow",children:[(0,t.jsxs)(w.Ol,{children:[(0,t.jsxs)(w.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(j.Z,{className:"h-5 w-5"}),"Schedule Post"]}),(0,t.jsx)(w.SZ,{children:"Schedule your post for future publication"})]}),(0,t.jsx)(w.aY,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)(N._,{htmlFor:"scheduledAt",children:"Publish Date & Time"}),(0,t.jsx)(v.I,{id:"scheduledAt",type:"datetime-local",value:V,onChange:e=>Y(e.target.value),min:(()=>{let e=new Date;return e.setMinutes(e.getMinutes()+30),e.toISOString().slice(0,16)})(),max:(()=>{let e=new Date;return e.setFullYear(e.getFullYear()+1),e.toISOString().slice(0,16)})(),className:"mt-1"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Leave empty to save as draft"})]})})]}),(0,t.jsxs)(w.Zb,{className:"card-shadow",children:[(0,t.jsx)(w.Ol,{children:(0,t.jsxs)(w.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5"}),"Preview"]})}),(0,t.jsx)(w.aY,{children:(0,t.jsx)("div",{className:"border rounded-lg p-4 bg-background",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(E.C,{variant:"outline",children:k}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:V?`Scheduled: ${new Date(V).toLocaleDateString()}`:"Draft"})]}),e&&(0,t.jsx)("h3",{className:"font-medium text-sm",children:e}),a&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-3",children:a}),U&&(0,t.jsx)("div",{className:"relative aspect-video rounded overflow-hidden bg-muted",children:(0,t.jsx)("img",{src:U,alt:"Preview",className:"w-full h-full object-cover"})})]})})})]}),(0,t.jsx)(w.Zb,{className:"card-shadow",children:(0,t.jsx)(w.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsx)(f.z,{onClick:()=>eo(!1),disabled:X||!e.trim()||!a.trim()||!V,className:"w-full",children:X?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Scheduling..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"Schedule Post"]})}),(0,t.jsx)(f.z,{onClick:()=>eo(!0),disabled:X||!e.trim()||!a.trim(),variant:"outline",className:"w-full",children:X?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Z,{className:"mr-2 h-4 w-4"}),"Save as Draft"]})})]})})})]})]})]})}},8420:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9205).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},1723:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9205).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])}},function(e){e.O(0,[972,73,500,605,675,290,960,612,846,971,117,744],function(){return e(e.s=7116)}),_N_E=e.O()}]);