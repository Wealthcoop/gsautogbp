(()=>{var e={};e.id=106,e.ids=[106],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},83460:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>o,routeModule:()=>m,tree:()=>d}),t(32550),t(27612),t(35866);var a=t(23191),l=t(88716),r=t(37922),i=t.n(r),n=t(95231),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["posts",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,32550)),"/home/ubuntu/gsautogbp/app/posts/new/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,27612)),"/home/ubuntu/gsautogbp/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],o=["/home/ubuntu/gsautogbp/app/posts/new/page.tsx"],u="/posts/new/page",h={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/posts/new/page",pathname:"/posts/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},27860:(e,s,t)=>{Promise.resolve().then(t.bind(t,90085)),Promise.resolve().then(t.bind(t,11539))},11539:(e,s,t)=>{"use strict";t.d(s,{default:()=>C});var a=t(10326),l=t(17577),r=t(4891),i=t(35047),n=t(86333),c=t(40765),d=t(59734),o=t(37358),u=t(71709),h=t(63685),m=t(77506),x=t(24527),p=t(48998),j=t(12714),g=t(31215),v=t(90772),f=t(54432),N=t(45842),y=t(87673),b=t(33071),w=t(34474),P=t(73427),S=t(567),E=t(94215),F=t(90434);function C(){let[e,s]=(0,l.useState)(""),[t,C]=(0,l.useState)(""),[Z,k]=(0,l.useState)("UPDATE"),[_,D]=(0,l.useState)(""),[q,T]=(0,l.useState)([]),[O,U]=(0,l.useState)(""),[I,M]=(0,l.useState)(""),[V,A]=(0,l.useState)(""),[Y,L]=(0,l.useState)(""),[G,z]=(0,l.useState)(""),[R,B]=(0,l.useState)(""),[Q,J]=(0,l.useState)(""),[H,W]=(0,l.useState)(""),[X,$]=(0,l.useState)(!1),[K,ee]=(0,l.useState)(!1),[es,et]=(0,l.useState)(null),[ea,el]=(0,l.useState)(!1),er=(0,i.useRouter)(),{toast:ei}=(0,E.pm)(),en=async()=>{if(!H.trim()){ei({title:"Error",description:"Please enter a description for the image",variant:"destructive"});return}$(!0);try{let e=await fetch("/api/generate-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:H})});if(e.ok){let s=await e.json();U(s.imageUrl),ei({title:"Success",description:"Image generated successfully"})}else throw Error("Failed to generate image")}catch(e){console.error("Error generating image:",e),ei({title:"Error",description:"Failed to generate image",variant:"destructive"})}finally{$(!1)}},ec=async(s=!0)=>{if(!e.trim()||!t.trim()){ei({title:"Error",description:"Please fill in title and content",variant:"destructive"});return}if(!es?.canCreatePost&&!s){ei({title:"Limit Reached",description:"You have reached your monthly post limit. Upgrade to unlimited plan.",variant:"destructive"});return}ee(!0);try{let a=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,content:t,type:Z,businessId:_||null,imageUrl:O||null,scheduledAt:!s&&I?I:null,eventStartDate:"EVENT"===Z?V:null,eventEndDate:"EVENT"===Z?Y:null,eventLocation:"EVENT"===Z?G:null,offerValidUntil:"OFFER"===Z?R:null,offerTerms:"OFFER"===Z?Q:null})});if(a.ok)ei({title:"Success",description:s?"Post saved as draft":"Post scheduled successfully"}),er.push("/posts");else{let e=await a.json();throw Error(e.error||"Failed to save post")}}catch(e){console.error("Error saving post:",e),ei({title:"Error",description:e.message||"Failed to save post",variant:"destructive"})}finally{ee(!1)}};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[a.jsx(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx(v.z,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)(F.default,{href:"/posts",children:[a.jsx(n.Z,{className:"h-4 w-4 mr-2"}),"Back to Posts"]})}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Create New Post"}),a.jsx("p",{className:"text-muted-foreground",children:"Create engaging content for your Google Business Profile"})]})]})}),es&&!es.canCreatePost&&a.jsx(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:a.jsx(b.Zb,{className:"border-destructive/50 bg-destructive/5",children:a.jsx(b.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:"Monthly limit reached"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["You've used ",es.currentUsage," of ",es.limit," posts this month"]})]}),a.jsx(v.z,{variant:"outline",size:"sm",asChild:!0,children:a.jsx(F.default,{href:"/upgrade",children:"Upgrade Plan"})})]})})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)(r.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)(b.Zb,{className:"card-shadow",children:[a.jsx(b.Ol,{children:(0,a.jsxs)(b.ll,{className:"flex items-center gap-2",children:[a.jsx(c.Z,{className:"h-5 w-5"}),"Post Details"]})}),(0,a.jsxs)(b.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"title",children:"Title"}),a.jsx(f.I,{id:"title",placeholder:"Enter post title...",value:e,onChange:e=>s(e.target.value),className:"mt-1"})]}),(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"type",children:"Post Type"}),(0,a.jsxs)(w.Ph,{value:Z,onValueChange:k,children:[a.jsx(w.i4,{className:"mt-1",children:a.jsx(w.ki,{})}),(0,a.jsxs)(w.Bw,{children:[a.jsx(w.Ql,{value:"UPDATE",children:"General Update"}),a.jsx(w.Ql,{value:"EVENT",children:"Event"}),a.jsx(w.Ql,{value:"OFFER",children:"Offer/Promotion"})]})]})]}),(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"business",children:"Business Location"}),(0,a.jsxs)(w.Ph,{value:_,onValueChange:D,children:[a.jsx(w.i4,{className:"mt-1",children:a.jsx(w.ki,{placeholder:ea?"Loading businesses...":"Select a business (optional)"})}),a.jsx(w.Bw,{children:q.length>0?q.map(e=>a.jsx(w.Ql,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(d.Z,{className:"h-4 w-4"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:e.name}),e.address&&a.jsx("div",{className:"text-xs text-muted-foreground",children:e.address})]})]})},e.id)):a.jsx(w.Ql,{value:"",disabled:!0,children:ea?"Loading...":"No businesses found"})})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a business to publish directly to Google Business Profile"})]}),(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"content",children:"Content"}),a.jsx(y.g,{id:"content",placeholder:"Write your post content here...",value:t,onChange:e=>C(e.target.value),className:"mt-1 min-h-32"})]})]})]}),"EVENT"===Z&&(0,a.jsxs)(b.Zb,{className:"card-shadow",children:[a.jsx(b.Ol,{children:(0,a.jsxs)(b.ll,{className:"flex items-center gap-2",children:[a.jsx(o.Z,{className:"h-5 w-5"}),"Event Details"]})}),(0,a.jsxs)(b.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"eventStartDate",children:"Start Date"}),a.jsx(f.I,{id:"eventStartDate",type:"datetime-local",value:V,onChange:e=>A(e.target.value),className:"mt-1"})]}),(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"eventEndDate",children:"End Date"}),a.jsx(f.I,{id:"eventEndDate",type:"datetime-local",value:Y,onChange:e=>L(e.target.value),className:"mt-1"})]})]}),(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"eventLocation",children:"Location"}),a.jsx(f.I,{id:"eventLocation",placeholder:"Event location...",value:G,onChange:e=>z(e.target.value),className:"mt-1"})]})]})]}),"OFFER"===Z&&(0,a.jsxs)(b.Zb,{className:"card-shadow",children:[a.jsx(b.Ol,{children:(0,a.jsxs)(b.ll,{className:"flex items-center gap-2",children:[a.jsx(c.Z,{className:"h-5 w-5"}),"Offer Details"]})}),(0,a.jsxs)(b.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"offerValidUntil",children:"Valid Until"}),a.jsx(f.I,{id:"offerValidUntil",type:"datetime-local",value:R,onChange:e=>B(e.target.value),className:"mt-1"})]}),(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"offerTerms",children:"Terms & Conditions"}),a.jsx(y.g,{id:"offerTerms",placeholder:"Terms and conditions...",value:Q,onChange:e=>J(e.target.value),className:"mt-1"})]})]})]})]}),(0,a.jsxs)(r.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.3},className:"space-y-6",children:[(0,a.jsxs)(b.Zb,{className:"card-shadow",children:[a.jsx(b.Ol,{children:(0,a.jsxs)(b.ll,{className:"flex items-center gap-2",children:[a.jsx(u.Z,{className:"h-5 w-5"}),"Post Image"]})}),(0,a.jsxs)(b.aY,{children:[(0,a.jsxs)(P.mQ,{defaultValue:"upload",className:"w-full",children:[(0,a.jsxs)(P.dr,{className:"grid w-full grid-cols-2",children:[a.jsx(P.SP,{value:"upload",children:"Upload"}),a.jsx(P.SP,{value:"generate",children:"AI Generate"})]}),a.jsx(P.nU,{value:"upload",className:"space-y-4",children:a.jsx("div",{className:"flex items-center justify-center w-full",children:(0,a.jsxs)("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer bg-muted hover:bg-muted/80 transition-colors",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[a.jsx(h.Z,{className:"w-8 h-8 mb-2 text-muted-foreground"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload image"})]}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:e=>{let s=e.target.files?.[0];if(s){let e=new FileReader;e.onload=e=>{U(e.target?.result)},e.readAsDataURL(s)}}})]})})}),(0,a.jsxs)(P.nU,{value:"generate",className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"imagePrompt",children:"Describe the image"}),a.jsx(y.g,{id:"imagePrompt",placeholder:"A professional business photo showing...",value:H,onChange:e=>W(e.target.value),className:"mt-1"})]}),a.jsx(v.z,{onClick:en,disabled:X||!H.trim(),className:"w-full",children:X?(0,a.jsxs)(a.Fragment,{children:[a.jsx(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(x.Z,{className:"mr-2 h-4 w-4"}),"Generate Image"]})})]})]}),O&&a.jsx("div",{className:"mt-4",children:a.jsx("div",{className:"relative aspect-video rounded-lg overflow-hidden bg-muted",children:a.jsx("img",{src:O,alt:"Post preview",className:"w-full h-full object-cover"})})})]})]}),(0,a.jsxs)(b.Zb,{className:"card-shadow",children:[(0,a.jsxs)(b.Ol,{children:[(0,a.jsxs)(b.ll,{className:"flex items-center gap-2",children:[a.jsx(p.Z,{className:"h-5 w-5"}),"Schedule Post"]}),a.jsx(b.SZ,{children:"Schedule your post for future publication"})]}),a.jsx(b.aY,{children:(0,a.jsxs)("div",{children:[a.jsx(N._,{htmlFor:"scheduledAt",children:"Publish Date & Time"}),a.jsx(f.I,{id:"scheduledAt",type:"datetime-local",value:I,onChange:e=>M(e.target.value),min:(()=>{let e=new Date;return e.setMinutes(e.getMinutes()+30),e.toISOString().slice(0,16)})(),max:(()=>{let e=new Date;return e.setFullYear(e.getFullYear()+1),e.toISOString().slice(0,16)})(),className:"mt-1"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Leave empty to save as draft"})]})})]}),(0,a.jsxs)(b.Zb,{className:"card-shadow",children:[a.jsx(b.Ol,{children:(0,a.jsxs)(b.ll,{className:"flex items-center gap-2",children:[a.jsx(j.Z,{className:"h-5 w-5"}),"Preview"]})}),a.jsx(b.aY,{children:a.jsx("div",{className:"border rounded-lg p-4 bg-background",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx(S.C,{variant:"outline",children:Z}),a.jsx("p",{className:"text-xs text-muted-foreground",children:I?`Scheduled: ${new Date(I).toLocaleDateString()}`:"Draft"})]}),e&&a.jsx("h3",{className:"font-medium text-sm",children:e}),t&&a.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:t}),O&&a.jsx("div",{className:"relative aspect-video rounded overflow-hidden bg-muted",children:a.jsx("img",{src:O,alt:"Preview",className:"w-full h-full object-cover"})})]})})})]}),a.jsx(b.Zb,{className:"card-shadow",children:a.jsx(b.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[a.jsx(v.z,{onClick:()=>ec(!1),disabled:K||!e.trim()||!t.trim()||!I,className:"w-full",children:K?(0,a.jsxs)(a.Fragment,{children:[a.jsx(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Scheduling..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(o.Z,{className:"mr-2 h-4 w-4"}),"Schedule Post"]})}),a.jsx(v.z,{onClick:()=>ec(!0),disabled:K||!e.trim()||!t.trim(),variant:"outline",className:"w-full",children:K?(0,a.jsxs)(a.Fragment,{children:[a.jsx(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(g.Z,{className:"mr-2 h-4 w-4"}),"Save as Draft"]})})]})})})]})]})]})}},59734:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(62881).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},48998:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(62881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},32550:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(19510),l=t(58585),r=t(75571),i=t(90455),n=t(40732);let c=(0,t(68570).createProxy)(String.raw`/home/ubuntu/gsautogbp/components/posts/post-editor.tsx#default`);async function d(){return await (0,r.getServerSession)((0,i.b)())||(0,l.redirect)("/login"),a.jsx(n.Z,{children:a.jsx(c,{})})}}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[276,903,283,404,129,964,970,847,583,12],()=>t(83460));module.exports=a})();